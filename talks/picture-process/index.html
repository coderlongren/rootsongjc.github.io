<!DOCTYPE html>
<html class="no-js" lang="en-US" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">

<head>
    <meta charset="utf-8">
    <meta name="baidu-site-verification" content="g8IYR9SNLF" />
    <meta name="uyan_auth" content="419f63884b" /> <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="description" content="">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="keywords" content="picture, tools, ">

 
<meta property="og:type" content="article"/>
<meta property="og:description" content=""/>
<meta property="og:title" content="两款图片处理工具——Google Guetzli和基于AI的Deep Photo Style Transfer : jimmysong.io"/>
<meta property="og:site_name" content="rootsongjc is Jimmy Song"/>
<meta property="og:image" content="" />
<meta property="og:image:type" content="image/jpeg" />
<meta property="og:image:width" content="" />
<meta property="og:image:height" content="" />
<meta property="og:url" content="https://jimmysong.io/talks/picture-process/">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2017-04-02"/>
<meta property="article:modified_time" content="2017-04-02"/>



<meta property="article:tag" content="picture">
<meta property="article:tag" content="tools">




<meta name="twitter:card" content="summary">

<meta name="twitter:site" content="@rootsongjc">
<meta name="twitter:title" content="两款图片处理工具——Google Guetzli和基于AI的Deep Photo Style Transfer : jimmysong.io">
<meta name="twitter:creator" content="@rootsongjc">
<meta name="twitter:description" content="">
<meta name="twitter:image:src" content="">
<meta name="twitter:domain" content="jimmysong.io">

    <base href="https://jimmysong.io/">
    <title> 两款图片处理工具——Google Guetzli和基于AI的Deep Photo Style Transfer - jimmysong.io focus on Cloud Native & Big Data </title>
    <link rel="canonical" href="https://jimmysong.io/talks/picture-process/"> <link rel="stylesheet" href="https://jimmysong.io/static/css/style.css">


<link href="https://jimmysong.io/static/css/prism.css" rel="stylesheet" />
<script type="text/javascript" src="https://jimmysong.io/static/js/prism.js"></script>


<script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?11f7d254cfa4e0ca44b175c66d379ecc";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>




    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
</head>


<body lang="en" itemscope itemtype="http://schema.org/Article">
    <header id="header">
    <figure>
      <a href="/" border=0 id="logolink"><div class="icon-octocat" id="logo"> </div></a>
    </figure>
    <div id="byline">by Jimmy Song</div>
    <nav id="nav">
    <ul id="mainnav">
    <li>
        <a href="/blogs/">
            <span class="icon"> <i aria-hidden="true" class="icon-quill"></i></span>
            <span> blogs </span>
        </a>
    </li>
    <li>
        <a href="/projects/">
            <span class="icon"> <i aria-hidden="true" class="icon-console"></i></span>
            <span> projects </span>
        </a>
    </li>
    <li>
        <a href="/talks/">
            <span class="icon"> <i aria-hidden="true" class="icon-stats"></i></span>
            <span> talks </span>
        </a>
    </li>
    <li>
        <a href="http://www.linkedin.com/in/rootsongjc">
            <span class="icon"> <i aria-hidden="true" class="icon-linkedin"></i></span>
            <span> me </span>
        </a>
    </li>
</ul>
    <ul id="social">
    <li id="share">
        <span class="icon icon-bubbles"> </span>
        <span class="title"> share </span>
        <div class="dropdown share">
            <ul class="social">
                <li> <a href="https://twitter.com/intent/tweet?status=%e4%b8%a4%e6%ac%be%e5%9b%be%e7%89%87%e5%a4%84%e7%90%86%e5%b7%a5%e5%85%b7%e2%80%94%e2%80%94Google%20Guetzli%e5%92%8c%e5%9f%ba%e4%ba%8eAI%e7%9a%84Deep%20Photo%20Style%20Transfer-https%3a%2f%2fjimmysong.io%2ftalks%2fpicture-process%2f" target="_blank" title="Follow me on Twitter" class="twitter"><span class="icon icon-twitter"></span>Twitter</a> </li>
                <li> <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fjimmysong.io%2ftalks%2fpicture-process%2f" target="_blank" title="Join me on Facebook" class="facebook"><span class="icon icon-facebook"></span>Facebook</a> </li>
                <li> <a href="https://plus.google.com/share?url=https%3a%2f%2fjimmysong.io%2ftalks%2fpicture-process%2f" target="_blank" title="Google+" class="googleplus"><span class="icon icon-google-plus"></span>Google+</a> </li>
                <li> <a href="http://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fjimmysong.io%2ftalks%2fpicture-process%2f&title=%e4%b8%a4%e6%ac%be%e5%9b%be%e7%89%87%e5%a4%84%e7%90%86%e5%b7%a5%e5%85%b7%e2%80%94%e2%80%94Google%20Guetzli%e5%92%8c%e5%9f%ba%e4%ba%8eAI%e7%9a%84Deep%20Photo%20Style%20Transfer&source=spf13" target="_blank" title="LinkedIn" class="linkedin"><span class="icon icon-linkedin"></span>LinkedIn</a> </li>
                <li> <a href="http://del.icio.us/post?url=https%3a%2f%2fjimmysong.io%2ftalks%2fpicture-process%2f" target="_blank" title="Delicious" class="delicious"><span class="icon icon-delicious"></span>Delicious</a> </li>
                <li> <a href="http://www.reddit.com/submit?url=https%3a%2f%2fjimmysong.io%2ftalks%2fpicture-process%2f" target="_blank" title="Reddit" class="reddit"><span class="icon icon-reddit"></span>Reddit</a> </li>
            </ul>
            <span class="subcount">sharing is caring</span>
        </div>
    </li>
    <li id="follow">
        <span class="icon icon-rocket"> </span>
        <span class="title"> follow </span>
        <div class="dropdown follow">
            <ul class="social">
                <li> <a href="http://www.twitter.com/jimmysongio" target="_blank" title="Follow me on Twitter" class="twitter"><span class="icon icon-twitter"></span>Twitter</a> </li>
                <li> <a href="http://www.facebook.com/rootsongjc" target="_blank" title="Join me on Facebook" class="facebook"><span class="icon icon-facebook"></span>Facebook</a> </li>
                <li> <a href="http://www.linkedin.com/in/rootsongjc" target="_blank" title="LinkedIn" class="linkedin"><span class="icon icon-linkedin"></span>LinkedIn</a> </li>
                <li> <a href="http://github.com/rootsongjc" target="_blank" title="GitHub" class="github"><span class="icon icon-github"></span>GitHub</a> </li>
                <li> <a href="https://www.douban.com/people/deamonj/" target="_blank" title="豆瓣" class="facebook"><span class="icon icon-idea"></span>Douban</a> </li>
                <li> <a href="https://rootsongjc.tuchong.com/" target="_blank" title="图虫" class="github"><span class="icon icon-cc-2"></span>Tuchong</a> </li>
            </ul>
            <span class="subcount">join 10k+ subscribers &amp; followers</span>
        </div>
    </li>
</ul>

    </nav>
</header>
 

    <section id="main">
        <h1 itemprop="name" id="title">两款图片处理工具——Google Guetzli和基于AI的Deep Photo Style Transfer</h1>
        <div>
            <article itemprop="articleBody" id="content">
                

<h2 id="前言">前言</h2>

<p>如果你看过美剧「硅谷」会记得剧中主角们所在的创业公司<a href="www.piedpiper.com">PiedPipper</a>，他们就是靠自己发明的视频压缩算法来跟大公司Hooli竞争的，这部剧现在已经发展到第4季，在<a href="http://v.qq.com/detail/d/dr2zn76oez8tyt4.html?ptag=baidu.aladdin.tv">腾讯视频</a>上可以免费观看。</p>

<p>最近关注了两个<strong>图像处理</strong>的Open Source Projects。</p>

<ul>
<li><a href="https://github.com/google/guetzli">Google Guetzli</a> 图像压缩工具</li>
<li><a href="https://github.com/luanfujun/deep-photo-styletransfer">Luan Fujun&rsquo;s Deep Photo Style Transfer</a> 图像style转换工具</li>
</ul>

<p>另外对于图像处理还处于Photoshop、Lightroom这种摄影后期和图像处理命令行工具<a href="https://www.imagemagick.org/script/index.php">ImageMagick</a>的我来说，图像压缩，智能图像风格转换实乃上乘武功，不是我等凡夫俗子驾驭的了，但是乘兴而来，总不能败兴而归吧，下面我们来一探究竟。</p>

<h2 id="google-guetzli">Google Guetzli</h2>

<p>聊聊架构微信公众号上有一篇介绍<a href="https://mp.weixin.qq.com/s?__biz=MzA5Nzc4OTA1Mw==&amp;mid=2659599074&amp;idx=1&amp;sn=a26ae2a8becdc1f2cfbddf44d8ca1495&amp;chksm=8be997f0bc9e1ee6e33f3e33c73d11884ad66085c0aedc9dd5e482063482887d0733d8e7d187#rd">Google开源新算法，可将JPEG文件缩小35%</a>文章。</p>

<p>我在Mac上试用了一下，安装很简单，只要一条命令：</p>

<pre><code class="language-shlell">brew install guetzli
</code></pre>

<p>但是当我拿一张<code>22M</code>大小的照片使用guetzli压缩的时候，我是绝望的，先后三次kill掉了进程。</p>

<p><strong>因为实在是太慢了</strong>，也能是我软件对内存和CPU的利用率不高，效果你们自己看看。</p>

<p>原图是这个样子的，拍摄地点在景山上的，俯瞰紫禁城的绝佳位置。</p>

<p><img src="http://olz1di9xf.bkt.clouddn.com/guetzli/IMG_5430.JPG" alt="原图" /></p>

<pre><code>guetzli --quality 84 --verbose 20160403052.jpg output.jpg
</code></pre>

<p>为什么quality要设置成84呢？因为只能设置为84+的quality，如果要设置的更低的话需要自己修改代码。</p>

<p><img src="http://olz1di9xf.bkt.clouddn.com/guetzli/IMG_5429.JPG" alt="process" /></p>

<p>耗时了一个小时，后台进程信息。</p>

<p><img src="http://olz1di9xf.bkt.clouddn.com/guetzli/IMG_5428.JPG" alt="后台进程" /></p>

<p>这个是使用<strong>Squash</strong>压缩后的大小效果，压缩每张照片差不多只要3秒钟。</p>

<blockquote>
<p>Squash的logo就是个正在被剥皮的🍊，这是<a href="http://xclient.info/s/squash.html">下载地址</a>。</p>
</blockquote>

<p>压缩比分别为<code>70%</code>和<code>30%</code>。</p>

<p><img src="http://olz1di9xf.bkt.clouddn.com/guetzli/IMG_5434.JPG" alt="Img" /></p>

<p><strong>压缩比70%后的细节放大图</strong></p>

<p><img src="http://olz1di9xf.bkt.clouddn.com/guetzli/IMG_5432.JPG" alt="70" /></p>

<p><strong>压缩比30%的细节放大图</strong></p>

<p><img src="http://olz1di9xf.bkt.clouddn.com/guetzli/IMG_5433.JPG" alt="30" /></p>

<p>你看出什么区别了吗？反正我是没有。</p>

<p>下面再来看看耗时一个小时，千呼万唤始出来的guetzli压缩后的效果和使用squash压缩比为30%的效果对比。</p>

<p><img src="http://olz1di9xf.bkt.clouddn.com/img/guetzli/FullSizeRender.jpg" alt="对比" /></p>

<p>左面是使用guetzli压缩后（4.1M），右面使用的squash压缩后（3.1M）的照片。</p>

<p><em>似乎还是没有什么区别啊？你看出来了吗？</em></p>

<h3 id="guetzli总结">Guetzli总结</h3>

<p>可能是我使用Guetzli的方式不对，但是命令行里确实没有设置CPU和内存资源的选项啊，为啥压缩照片会这么慢呢？效果也并不出彩，不改代码的话照片质量只能设置成84以上，但是这个是<strong>Open Source</strong>的，使用的C++开发，可以研究下它的图像压缩算法。</p>

<h1 id="deep-photo-style-transfer">Deep Photo Style Transfer</h1>

<p>来自康奈尔大学的Luan Fujun开源的图像sytle转换工具，看了<a href="https://github.com/luanfujun/deep-photo-styletransfer">README</a>的介绍，上面有很多图像风格转换的例子，真的很惊艳，市面上好像还没有这种能够在给定任意一张照片的情况下，自动将另一张照片转换成该照片的style。</p>

<p>这个工具使用Matlab和Lua开发，基于<a href="https://github.com/torch/torch7">Torch</a>运行的时候需要<a href="https://developer.nvidia.com/cuda-downloads">CUDA</a>，<a href="https://developer.nvidia.com/cudnn">cudnn</a>，<a href="https://www.mathworks.com/">Matlab</a>，环境实在太复杂，就没折腾，启动有人发布<a href="https://github.com/luanfujun/deep-photo-styletransfer/issues/29">Docker镜像</a>，已经有人提了issue。</p>

<p>如果它能够被商用，绝对是继<strong>Prisma</strong>后又一人工智能照片处理应用利器。</p>

<h2 id="后记">后记</h2>

<p>是不是有了照片风格转换这个东西就不需要做照片后期了？只要选几张自己喜欢的风格照片，再鼠标点几下就可以完成照片处理了？摄影师要失业了？非也！照片风格东西本来就是很主观性的，每个人都有自己喜欢的风格，照相机发明后就有人说画家要失业了，其实不然，画画依然是创造性地劳动，只能说很多写实风格的画家要失业了。Deep Photo Style Transfer也许会成为Lightroom或者手机上一款app的功能，是一个不错的工具。也许还会成为像Prisma一样的现象级产品，who knows?🤷‍♂️</p>

            </article>
             
            <h2>See Also</h2>
            <ul>
                
                <li><a href="/blogs/packer-intro/">开源镜像定义工具Packer简介</a></li>
                
                <li><a href="/blogs/vagrant-intro/">Vagrant介绍-从使用到放弃完全指南</a></li>
                
            </ul>
            
        </div>
    </section>

    
    

<aside id="meta">

<div>
    <section id="datecount">
        <h4 id="date"> Sun Apr 2, 2017 </h4>
        <h5 id="wc"> 1400 Words </h5>
        <h5 id="readtime"> Read in about 3 Min </h5>
    </section>
    <ul id="categories">
        
    </ul>
    <ul id="tags">
        
        <li> <a href="https://jimmysong.io//tags/picture">picture</a> </li>
        
        <li> <a href="https://jimmysong.io//tags/tools">tools</a> </li>
        
    </ul>
</div>

<div>
    <section id="prev">
        &nbsp;<a class="previous" href="https://jimmysong.io/projects/yarn-on-docker/"><i class="icon-arrow-left"></i> 容器技术在大数据场景下的应用——Yarn on Docker</a><br>
    </section>
    <section id="next">
        &nbsp;<a class="next" href="https://jimmysong.io/blogs/kubernetes-network-config/">Kubernetes基于flannel的网络配置 <i class="icon-arrow-right"></i></a>
    </section>
</div>

<div>
    <section id="author">
        <h4>About the Author</h4>
        <p>
            <a href="https://jimmysong.io/about/">Jimmy Song</a> is a software engineer in Beijing, also an open source enthusiast and Big Data, Cloud Native fans. If you not see him front of computer, he must be traveling or taking pictures outside,
            visit the amazing pictures at <a href=https://rootsongjc.tuchong.com/>tuchong(图虫)</a>. Feel free to <a href=https://twitter.com/jimmysongio>follow him on twitter</a>.
        </p>
    </section>

</div>

</aside>

<meta itemprop="wordCount" content="1362">
<meta itemprop="datePublished" content="2017-04-02">
<meta itemprop="url" content="https://jimmysong.io/talks/picture-process/">
 <footer>
    <div>
        <p>
            <a href="https://jimmysong.io/kubernetes-handbook">Kubernetes Handbook</a> |
            <a href="https://jimmysong.io/cloud-native-go">Cloud Native Go</a> |
            <a href="https://jimmysong.io/awesome-cloud-native">Awesome Cloud Native</a> |
            <a href="https://jimmysong.io/migrating-to-cloud-native-application-architectures">Migrating to Cloud Native Application Architectures</a>
    </div>
    <div>
        <p>

        </p>
        <p> &copy; 2013-2017 <span itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Jimmy Song</span><span>
            Powered by <a href="https://gohugo.io">Hugo</a></span>
            </span>
    </div>
</footer>
</body>

</html>