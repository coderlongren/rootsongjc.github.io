<!DOCTYPE html>
<html class="no-js" lang="en-US" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">

<head>
    <meta charset="utf-8">
    <meta name="baidu-site-verification" content="g8IYR9SNLF" />
    <meta name="uyan_auth" content="419f63884b" /> <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="description" content="">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="keywords" content="devops, design, tools, ">

 
<meta property="og:type" content="article"/>
<meta property="og:description" content=""/>
<meta property="og:title" content="使用API blueprint创建API文档 : jimmysong.io"/>
<meta property="og:site_name" content="rootsongjc is Jimmy Song"/>
<meta property="og:image" content="" />
<meta property="og:image:type" content="image/jpeg" />
<meta property="og:image:width" content="" />
<meta property="og:image:height" content="" />
<meta property="og:url" content="http://rootsongjc.github.io/blogs/creating-api-document-with-api-blueprint/">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2017-06-23"/>
<meta property="article:modified_time" content="2017-06-23"/>



<meta property="article:tag" content="devops">
<meta property="article:tag" content="design">
<meta property="article:tag" content="tools">




<meta name="twitter:card" content="summary">

<meta name="twitter:site" content="@rootsongjc">
<meta name="twitter:title" content="使用API blueprint创建API文档 : jimmysong.io">
<meta name="twitter:creator" content="@rootsongjc">
<meta name="twitter:description" content="">
<meta name="twitter:image:src" content="">
<meta name="twitter:domain" content="jimmysong.io">

    <base href="http://rootsongjc.github.io/">
    <title> 使用API blueprint创建API文档 - Jimmy Song </title>
    <link rel="canonical" href="http://rootsongjc.github.io/blogs/creating-api-document-with-api-blueprint/"> 
<link rel="stylesheet" href="/static/css/style.css">
<script src="https://yandex.st/highlightjs/8.0/highlight.min.js"></script>
<link rel="stylesheet" href="https://yandex.st/highlightjs/8.0/styles/default.min.css">
<script>
    hljs.initHighlightingOnLoad();
</script>

<script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?11f7d254cfa4e0ca44b175c66d379ecc";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

<script>
    (function() {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>
<div style='margin:0 auto;width:0px;height:0px;overflow:hidden; '>
    <img src='http://olz1di9xf.bkt.clouddn.com/jimmy.jpg' />
</div>
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
</head>

<body lang="en" itemscope itemtype="http://schema.org/Article">
    <header id="header">
    <figure>
      <a href="/" border=0 id="logolink"><div class="icon-octocat" id="logo"> </div></a>
    </figure>
    <div id="byline">by Jimmy Song</div>
    <nav id="nav">
            <ul id="mainnav">
            <li>
                <a href="/blogs/">
                <span class="icon"> <i aria-hidden="true" class="icon-quill"></i></span>
                <span> blogs </span>
            </a>
            </li>
            <li>
            <a href="/projects/">
                <span class="icon"> <i aria-hidden="true" class="icon-console"></i></span>
                <span> projects </span>
            </a>
            </li>
            <li>
            <a href="/talks/">
                <span class="icon"> <i aria-hidden="true" class="icon-stats"></i></span>
                <span> talks </span>
            </a>
            </li>
            <li>
            <a href="http://www.linkedin.com/in/rootsongjc">
                <span class="icon"> <i aria-hidden="true" class="icon-linkedin"></i></span>
                <span> me </span>
            </a>
            </li>
        </ul>

    <ul id="social">
    <li id="share">
        <span class="icon icon-bubbles"> </span>
        <span class="title"> share </span>
        <div class="dropdown share">
            <ul class="social">
                <li> <a href="https://twitter.com/intent/tweet?status=%e4%bd%bf%e7%94%a8API%20blueprint%e5%88%9b%e5%bb%baAPI%e6%96%87%e6%a1%a3-http%3a%2f%2frootsongjc.github.io%2fblogs%2fcreating-api-document-with-api-blueprint%2f" target="_blank" title="Follow me on Twitter" class="twitter"><span class="icon icon-twitter"></span>Twitter</a> </li>
                <li> <a href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2frootsongjc.github.io%2fblogs%2fcreating-api-document-with-api-blueprint%2f" target="_blank" title="Join me on Facebook" class="facebook"><span class="icon icon-facebook"></span>Facebook</a> </li>
                <li> <a href="https://plus.google.com/share?url=http%3a%2f%2frootsongjc.github.io%2fblogs%2fcreating-api-document-with-api-blueprint%2f" target="_blank" title="Google+" class="googleplus"><span class="icon icon-google-plus"></span>Google+</a> </li>
                <li> <a href="http://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2frootsongjc.github.io%2fblogs%2fcreating-api-document-with-api-blueprint%2f&title=%e4%bd%bf%e7%94%a8API%20blueprint%e5%88%9b%e5%bb%baAPI%e6%96%87%e6%a1%a3&source=spf13" target="_blank" title="LinkedIn" class="linkedin"><span class="icon icon-linkedin"></span>LinkedIn</a> </li>
                <li> <a href="http://del.icio.us/post?url=http%3a%2f%2frootsongjc.github.io%2fblogs%2fcreating-api-document-with-api-blueprint%2f" target="_blank" title="Delicious" class="delicious"><span class="icon icon-delicious"></span>Delicious</a> </li>
                <li> <a href="http://www.reddit.com/submit?url=http%3a%2f%2frootsongjc.github.io%2fblogs%2fcreating-api-document-with-api-blueprint%2f" target="_blank" title="Reddit" class="reddit"><span class="icon icon-reddit"></span>Reddit</a> </li>
            </ul>
            <span class="subcount">sharing is caring</span>
        </div>
    </li>
    <li id="follow">
        <span class="icon icon-rocket"> </span>
        <span class="title"> follow </span>
        <div class="dropdown follow">
            <ul class="social">
                <li> <a href="http://www.twitter.com/rootsongjc" target="_blank" title="Follow me on Twitter" class="twitter"><span class="icon icon-twitter"></span>Twitter</a> </li>
                <li> <a href="http://www.facebook.com/rootsongjc" target="_blank" title="Join me on Facebook" class="facebook"><span class="icon icon-facebook"></span>Facebook</a> </li>
                <li> <a href="http://www.linkedin.com/in/rootsongjc" target="_blank" title="LinkedIn" class="linkedin"><span class="icon icon-linkedin"></span>LinkedIn</a> </li>
                <li> <a href="http://github.com/rootsongjc" target="_blank" title="GitHub" class="github"><span class="icon icon-github"></span>GitHub</a> </li>
                <li> <a href="https://www.douban.com/people/deamonj/" target="_blank" title="豆瓣" class="facebook"><span class="icon icon-idea"></span>Douban</a> </li>
                <li> <a href="https://rootsongjc.tuchong.com/" target="_blank" title="图虫" class="github"><span class="icon icon-cc-2"></span>Tuchong</a> </li>
            </ul>
            <span class="subcount">join 10k+ subscribers &amp; followers</span>
        </div>
    </li>
</ul>
    </nav>
</header>
 

    <section id="main">
        <h1 itemprop="name" id="title">使用API blueprint创建API文档</h1>
        <div>
            <article itemprop="articleBody" id="content">
                

<p>在进行微服务开发的过程中，为了保证最终开发的系统跟最初的设计保持一致，约定RESTful接口之间的调用方法，我们需要将API设计文档化，因此我们引入了API Blueprint。</p>

<h2 id="api-blueprint-是什么">API Blueprint 是什么</h2>

<p><a href="https://apiblueprint.org/">API Blueprint</a> 用来编写API文档的一种标记语言，类似于Markdown，因为是纯文本的，所以方便共享编辑，具体的语法规则可以在 <a href="https://apiblueprint.org/documentation/">API Blueprint documentation</a> 查看，配合一些开源的工具可以把接口文档渲染成 html 再搭配一个静态服务器，方便于分享。</p>

<p>另外，配合一些工具，可以直接生成一个 mock data 数据，这样只要和后端的同学约定好接口格式，那么前端再开发的时候可以使用 mock data 数据来做测试，等到后端写好接口之后再做联调就可以了。</p>

<p>我们以<a href="http://rootsongjc.github.io/cloud-native-go">Cloud Native Go</a>书中的<a href="https://github.com/rootsongjc/gogo-service">gogo-service</a>示例里的<code>apiary.apib</code>文件为例。</p>

<p>该文件实际上是一个Markdown格式的文件，Github中原生支持该文件，使用<a href="https://typora.io">Typora</a>打开后是这样子。</p>

<p><img src="http://olz1di9xf.bkt.clouddn.com/apiary-api-blueprint.jpg" alt="apiary.apib文件" /></p>

<p>在Visual Studio Code中有个API Element extension对于API Blueprint文件的支持也比较好。</p>

<h2 id="生成静态页面和进行冒烟测试">生成静态页面和进行冒烟测试</h2>

<p>我们分别使用开源的<a href="https://github.com/danielgtaylor/aglio">aglio</a>和<a href="https://github.com/Aconex/drakov">drakov</a>来生成静态页面和进行冒烟测试。</p>

<p><a href="https://github.com/danielgtaylor/aglio">aglio</a> 是一个可以根据 api-blueprint 的文档生成静态 HTML 页面的工具。</p>

<p>其生成的工具不是简单的 markdown 到 html 的转换, 而是可以生成类似 rdoc 这样的拥有特定格式风格的查询文档。</p>

<p>在本地安装有node环境的情况下，使用下面的命令安装和使用aglio。</p>

<pre><code class="language-bash">$ npm install -g aglio
$ aglio -i apiary.apib -o api.html
</code></pre>

<p>打开api.html文件后，如图：</p>

<p><img src="http://olz1di9xf.bkt.clouddn.com/api-blueprint-html.jpg" alt="使用aglio生成的API文档" /></p>

<p>安装和使用drakov。</p>

<pre><code class="language-bash">$ npm install -g drakov
$ drakov -f apiary.apib -p 3000
[INFO] No configuration files found
[INFO] Loading configuration from CLI
   DRAKOV STARTED   
[LOG] Setup Route: GET /matches List All Matches
[LOG] Setup Route: POST /matches Start a New Match
[LOG] Setup Route: GET /matches/:match_id Get Match Details
[LOG] Setup Route: GET /matches/:match_id Get Current Liberties for Match
[LOG] Setup Route: GET /matches/:match_id Get Current Chains for Match
[LOG] Setup Route: GET /matches/:match_id/moves Get a Sequential List of All Moves Performed in a Match
[LOG] Setup Route: POST /matches/:match_id/moves Make a Move
   Drakov 1.0.4      Listening on port 3000
</code></pre>

<p>通过<code>http://localhost:3000</code>就可以对该应用进行冒烟测试了。</p>

<p>例如查询有哪些match：</p>

<pre><code class="language-bash">$ curl http://localhost:3000/matches
[
    {
        &quot;id&quot; : &quot;5a003b78-409e-4452-b456-a6f0dcee05bd&quot;,
        &quot;started_at&quot;: 13231239123391,
        &quot;turn&quot; : 27,
        &quot;gridsize&quot; : 19,
        &quot;playerWhite&quot; : &quot;bob&quot;,
        &quot;playerBlack&quot; : &quot;alfred&quot;
    }
]
</code></pre>

<p>另外通过<a href="https://apiary.io">Apiary</a>这个网站，我们可以直接以上的所有功能，还可以同时在页面上进行mock test，生成多种语言的code example。如图：</p>

<p><img src="http://olz1di9xf.bkt.clouddn.com/apiary-gogo-service.jpg" alt="Apiary页面" /></p>

            </article>
        </div>
    </section>

    
    

<aside id="meta">

<div>
    <section id="datecount">
        <h4 id="date"> Fri Jun 23, 2017 </h4>
        <h5 id="wc"> 900 Words </h5>
        <h5 id="readtime"> Read in about 2 Min </h5>
    </section>
    <ul id="categories">
        
    </ul>
    <ul id="tags">
        
        <li> <a href="http://rootsongjc.github.io//tags/devops">devops</a> </li>
        
        <li> <a href="http://rootsongjc.github.io//tags/design">design</a> </li>
        
        <li> <a href="http://rootsongjc.github.io//tags/tools">tools</a> </li>
        
    </ul>
</div>

<div>
    <section id="prev">
        &nbsp;<a class="previous" href="http://rootsongjc.github.io/blogs/kubernetes-pod-cheetsheet/"><i class="icon-arrow-left"></i> Kubernetes Pod Cheat Sheet——Pod数据结构参考图</a><br>
    </section>
    <section id="next">
        &nbsp;<a class="next" href="http://rootsongjc.github.io/blogs/continuous-integration-with-wercker/">使用Wercker进行持续构建与发布 <i class="icon-arrow-right"></i></a>
    </section>
</div>

<div>
    <section id="author">
        <h4>About the Author</h4>
        <p>
            <a href="http://rootsongjc.github.io/about/">Jimmy Song</a> is a software engineer in Beijing, also an open source enthusiast and Big Data, Cloud Native fans. If you not see him front of computer, he must be traveling or taking pictures outside,
            visit the amazing pictures at <a href=https://rootsongjc.tuchong.com/>tuchong(图虫)</a>. Feel free to <a href=https://twitter.com/rootsongjc>follow him on twitter</a>.
        </p>
    </section>

</div>
</aside>

<meta itemprop="wordCount" content="856">
<meta itemprop="datePublished" content="2017-06-23">
<meta itemprop="url" content="http://rootsongjc.github.io/blogs/creating-api-document-with-api-blueprint/">
 <footer>
  <div>
    <p>
    &copy; 2013-2017 <span itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Jimmy Song</span></span>
    Powered by <a href="http://gohugo.io">Hugo</a>.
    </p>
  </div>
</footer>
</body>
</html>

