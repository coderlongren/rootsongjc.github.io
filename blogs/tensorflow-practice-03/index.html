<!DOCTYPE html>
<html class="no-js" lang="en-US" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="baidu-site-verification" content="g8IYR9SNLF" />
    <meta name="uyan_auth" content="419f63884b" /> <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="description" content="">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="keywords" content="tensorflow, deep learning, AI, google, machine learning, reading notes, book, tensorflow practice reading notes, ">

 
<meta property="og:type" content="article"/>
<meta property="og:description" content=""/>
<meta property="og:title" content="TensorFlow实战（才云郑泽宇著）读书笔记——第三章TensorFlow入门 : jimmysong.io"/>
<meta property="og:site_name" content="rootsongjc is Jimmy Song"/>
<meta property="og:image" content="" />
<meta property="og:image:type" content="image/jpeg" />
<meta property="og:image:width" content="" />
<meta property="og:image:height" content="" />
<meta property="og:url" content="https://jimmysong.io/blogs/tensorflow-practice-03/">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2017-03-30"/>
<meta property="article:modified_time" content="2017-03-30"/>



<meta property="article:tag" content="tensorflow">
<meta property="article:tag" content="deep learning">
<meta property="article:tag" content="AI">
<meta property="article:tag" content="google">
<meta property="article:tag" content="machine learning">
<meta property="article:tag" content="reading notes">
<meta property="article:tag" content="book">
<meta property="article:tag" content="tensorflow practice reading notes">




<meta name="twitter:card" content="summary">

<meta name="twitter:site" content="@rootsongjc">
<meta name="twitter:title" content="TensorFlow实战（才云郑泽宇著）读书笔记——第三章TensorFlow入门 : jimmysong.io">
<meta name="twitter:creator" content="@rootsongjc">
<meta name="twitter:description" content="">
<meta name="twitter:image:src" content="">
<meta name="twitter:domain" content="jimmysong.io">

    <base href="https://jimmysong.io/">
    <title> TensorFlow实战（才云郑泽宇著）读书笔记——第三章TensorFlow入门 - jimmysong.io focus on Cloud Native & Big Data </title>
    <link rel="canonical" href="https://jimmysong.io/blogs/tensorflow-practice-03/"> <link rel="stylesheet" href="https://jimmysong.io/static/css/style.css">


<link href="https://jimmysong.io/static/css/prism.css" rel="stylesheet" />
<script type="text/javascript" src="https://jimmysong.io/static/js/prism.js"></script>


<script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?11f7d254cfa4e0ca44b175c66d379ecc";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>





    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
</head>


<body lang="en" itemscope itemtype="http://schema.org/Article">
    <header id="header">
    <figure>
      <a href="/" border=0 id="logolink"><div class="icon-octocat" id="logo"> </div></a>
    </figure>
    <div id="byline">by Jimmy Song</div>
    <nav id="nav">
    <ul id="mainnav">
    <li>
        <a href="/blogs/">
            <span class="icon"> <i aria-hidden="true" class="icon-quill"></i></span>
            <span> blogs </span>
        </a>
    </li>
    <li>
        <a href="/projects/">
            <span class="icon"> <i aria-hidden="true" class="icon-console"></i></span>
            <span> projects </span>
        </a>
    </li>
    <li>
        <a href="/talks/">
            <span class="icon"> <i aria-hidden="true" class="icon-stats"></i></span>
            <span> talks </span>
        </a>
    </li>
    <li>
        <a href="http://www.linkedin.com/in/rootsongjc">
            <span class="icon"> <i aria-hidden="true" class="icon-linkedin"></i></span>
            <span> me </span>
        </a>
    </li>
</ul>
    <ul id="social">
    <li id="share">
        <span class="icon icon-bubbles"> </span>
        <span class="title"> share </span>
        <div class="dropdown share">
            <ul class="social">
                <li> <a href="https://twitter.com/intent/tweet?status=TensorFlow%e5%ae%9e%e6%88%98%ef%bc%88%e6%89%8d%e4%ba%91%e9%83%91%e6%b3%bd%e5%ae%87%e8%91%97%ef%bc%89%e8%af%bb%e4%b9%a6%e7%ac%94%e8%ae%b0%e2%80%94%e2%80%94%e7%ac%ac%e4%b8%89%e7%ab%a0TensorFlow%e5%85%a5%e9%97%a8-https%3a%2f%2fjimmysong.io%2fblogs%2ftensorflow-practice-03%2f" target="_blank" title="Follow me on Twitter" class="twitter"><span class="icon icon-twitter"></span>Twitter</a> </li>
                <li> <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fjimmysong.io%2fblogs%2ftensorflow-practice-03%2f" target="_blank" title="Join me on Facebook" class="facebook"><span class="icon icon-facebook"></span>Facebook</a> </li>
                <li> <a href="https://plus.google.com/share?url=https%3a%2f%2fjimmysong.io%2fblogs%2ftensorflow-practice-03%2f" target="_blank" title="Google+" class="googleplus"><span class="icon icon-google-plus"></span>Google+</a> </li>
                <li> <a href="http://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fjimmysong.io%2fblogs%2ftensorflow-practice-03%2f&title=TensorFlow%e5%ae%9e%e6%88%98%ef%bc%88%e6%89%8d%e4%ba%91%e9%83%91%e6%b3%bd%e5%ae%87%e8%91%97%ef%bc%89%e8%af%bb%e4%b9%a6%e7%ac%94%e8%ae%b0%e2%80%94%e2%80%94%e7%ac%ac%e4%b8%89%e7%ab%a0TensorFlow%e5%85%a5%e9%97%a8&source=spf13" target="_blank" title="LinkedIn" class="linkedin"><span class="icon icon-linkedin"></span>LinkedIn</a> </li>
                <li> <a href="http://del.icio.us/post?url=https%3a%2f%2fjimmysong.io%2fblogs%2ftensorflow-practice-03%2f" target="_blank" title="Delicious" class="delicious"><span class="icon icon-delicious"></span>Delicious</a> </li>
                <li> <a href="http://www.reddit.com/submit?url=https%3a%2f%2fjimmysong.io%2fblogs%2ftensorflow-practice-03%2f" target="_blank" title="Reddit" class="reddit"><span class="icon icon-reddit"></span>Reddit</a> </li>
            </ul>
            <span class="subcount">sharing is caring</span>
        </div>
    </li>
    <li id="follow">
        <span class="icon icon-rocket"> </span>
        <span class="title"> follow </span>
        <div class="dropdown follow">
            <ul class="social">
                <li> <a href="http://www.twitter.com/jimmysongio" target="_blank" title="Follow me on Twitter" class="twitter"><span class="icon icon-twitter"></span>Twitter</a> </li>
                <li> <a href="http://www.facebook.com/jimmysongio" target="_blank" title="Join me on Facebook" class="facebook"><span class="icon icon-facebook"></span>Facebook</a> </li>
                <li> <a href="http://www.linkedin.com/in/jimmysongio" target="_blank" title="LinkedIn" class="linkedin"><span class="icon icon-linkedin"></span>LinkedIn</a> </li>
                <li> <a href="http://github.com/rootsongjc" target="_blank" title="GitHub" class="github"><span class="icon icon-github"></span>GitHub</a> </li>
                <li> <a href="https://www.douban.com/people/deamonj/" target="_blank" title="豆瓣" class="facebook"><span class="icon icon-idea"></span>Douban</a> </li>
                <li> <a href="https://jimmysongio.tuchong.com/" target="_blank" title="图虫" class="github"><span class="icon icon-cc-2"></span>Tuchong</a> </li>
            </ul>
            <span class="subcount">join 10k+ subscribers &amp; followers</span>
        </div>
    </li>
</ul>

    </nav>
</header>
 

    <section id="main">
        <h1 itemprop="name" id="title">TensorFlow实战（才云郑泽宇著）读书笔记——第三章TensorFlow入门</h1>
        <div>
            <article itemprop="articleBody" id="content">
                

<p><img src="http://olz1di9xf.bkt.clouddn.com/2015052401.jpg" alt="扬州东关" /></p>

<p><em>（题图：扬州东关 May 24,2015）</em></p>

<p><em>这是我阅读<a href="caicloud.io">才云科技</a>郑泽宇的《TensorFlow实战Google深度学习框架》的读书笔记系列文章，按照文章的章节顺序来写的。整本书的笔记归档在<a href="http://rootsongjc.github.io/tags/tensorflow-practice-reading-notes/">这里</a>。</em></p>

<p>P.S 本书的<strong>官方读者交流微信群（作者也在群里）</strong>已经超过100人，您可以先加我微信后我拉您进去，我的二维码在<a href="rootsongjc.github.io/about">这里</a>，或者直接搜索我的微信号jimmysong。</p>

<p>这一章从三个角度带大家入门。</p>

<p>分别是TensorFlow的</p>

<ul>
<li>计算模型</li>
<li>数据模型</li>
<li>运行模型</li>
</ul>

<h2 id="3-1-tensorflow的计算模型-图计算">3.1 TensorFlow的计算模型——图计算</h2>

<p><strong>计算图</strong>是TensorFlow中的一个最基本的概念，<u>TensorFlow中的所有计算都会转化成计算图上的节点</u>。</p>

<p>其实TensorFlow的名字已经暗示了它的实现方式了，<strong>Tensor</strong>表示的是数据结构——张量，<strong>Flow</strong>表示数据流——Tensor通过数据流相互转化。</p>

<p><strong>常用的方法</strong></p>

<ul>
<li>在python中导入tensorflow：import tensorflow as tf</li>
<li>获取当前默认的计算图：tf.get_default_graph()</li>
<li>生成新的计算图：tf.Graph()</li>
</ul>

<p>书中这里都有例子讲解，可以从Github中<a href="https://github.com/caicloud/tensorflow-tutorial">下载代码</a>，或者如果你使用才云提供的docker镜像的方式安装的话，在jupyter中可以看到各个章节的代码。</p>

<p><strong>定义两个不同的图</strong></p>

<pre><code class="language-python">import tensorflow as tf

g1 = tf.Graph()
with g1.as_default():
    v = tf.get_variable(&quot;v&quot;, [1], initializer = tf.zeros_initializer) # 设置初始值为0

g2 = tf.Graph()
with g2.as_default():
    v = tf.get_variable(&quot;v&quot;, [1], initializer = tf.ones_initializer())  # 设置初始值为1
    
with tf.Session(graph = g1) as sess:
    tf.global_variables_initializer().run()
    with tf.variable_scope(&quot;&quot;, reuse=True):
        print(sess.run(tf.get_variable(&quot;v&quot;)))

with tf.Session(graph = g2) as sess:
    tf.global_variables_initializer().run()
    with tf.variable_scope(&quot;&quot;, reuse=True):
        print(sess.run(tf.get_variable(&quot;v&quot;)))
</code></pre>

<p>我们看到这里面用了<a href="https://www.ibm.com/developerworks/cn/opensource/os-cn-pythonwith/">python中的with语法</a>，不了解的可以到前面那个链接看看。</p>

<blockquote>
<p>with 语句适用于对资源进行访问的场合，确保不管使用过程中是否发生异常都会执行必要的“清理”操作，释放资源，比如文件使用后自动关闭、线程中锁的自动获取和释放等。</p>
</blockquote>

<p><strong>TensorFlow中维护的集合列表</strong></p>

<table>
<thead>
<tr>
<th>集合名称</th>
<th>集合内容</th>
<th>使用场景</th>
</tr>
</thead>

<tbody>
<tr>
<td>tf.GraphKeys.VARIABLES</td>
<td>所有变量</td>
<td>持久化TensorFlow模型</td>
</tr>

<tr>
<td>tf.GraphKeys.TRAINABLE_VARIABLES</td>
<td>可学习的变量（一般指神经网络中的参数）</td>
<td>模型训练、生活从呢个模型可视化内容</td>
</tr>

<tr>
<td>tf.GraphKeys.SUMMARIES</td>
<td>与日志有关的张量</td>
<td>TensorFlow计算可视化</td>
</tr>

<tr>
<td>tf.GraphKeys.QUEUE_RUNNERS</td>
<td>处理输入的QueueRunner</td>
<td>输入处理</td>
</tr>

<tr>
<td>tf.GraphKeys.MOVING_AVERAGE_VARIABLES</td>
<td>所有计算了滑动平均值的变量</td>
<td>计算变量的滑动平均值</td>
</tr>
</tbody>
</table>

<p><em>所谓的滑动平均值即移动平均值，熟悉股票的应该都知道均线的概念吧，5日均线，20日均线，30日均线啥的，一般称作MA(Moving Average)。</em></p>

<h2 id="3-2-tensorflow数据模型-张量">3.2 TensorFlow数据模型——张量</h2>

<p>张量（Tensor）是TensorFlow中所有数据的表现形式。我们可以简单的将Tensor理解为<strong>多维数组</strong>：</p>

<ul>
<li>0阶的话就是一个标量（Scalar），可以是一个数也可以是一个字符串</li>
<li>一阶的话是向量（Vector）</li>
<li>n阶的话就是n维数组</li>
</ul>

<p>Tensor在TensorFlow中并不是直接采用数组的形式，而是<strong>对TF中计算结果的引用</strong>，保存的是如何得到这些数字的过程。</p>

<p><strong>举个例子</strong></p>

<pre><code class="language-Python">import tensorflow as tf
a = tf.constant([1.0, 2.0], name=&quot;a&quot;)
b = tf.constant([2.0, 3.0], name=&quot;b&quot;)
result = tf.add(a,b,name=&quot;add&quot;)
print result
</code></pre>

<p>输出结果：</p>

<pre><code class="language-python">Tensor(&quot;add:0&quot;, shape=(2,), dtype=float32)
[ 3.  5.]
</code></pre>

<p>这个例子只是简单的做了个加法，下面结合上面的例子来讲解。</p>

<p><strong>Tensor的3个属性</strong>：</p>

<ul>
<li><strong>名字（Name）</strong>：Tensor的唯一标识符，如例子中的a, b, result，这是我们手动指定的，实际上Tensor是与计算图上的每个节点一一对应的，tensor的命名可以通过<code>node:src_output</code>的形式给出，如例子输出中的计算结果名字为<strong>add:0</strong>，0表示的是计算节点<strong>add</strong>输出的第一个结果。</li>
<li><strong>维度（Shape）</strong>：如上面例子结果输出中的<strong>shape=(2,)</strong>，表示这个张量是一维数组，数组的长度是2。</li>
<li><strong>类型（Type）</strong>：所有参与运算的张量的类型必须是相同的，比如不能float和int之间运算。TensorFlow会自动检查张量的类型，可以通过<strong>dtype=df.float32</strong>这样的声明来指定类型，如果不指定的话，TF会根据值确定默认类型。</li>
</ul>

<p><strong>Tensor的用途</strong></p>

<ul>
<li>作为对计算中间结果的引用，比如上面例子中的a和b，在复杂计算中使用tensor能够增加代码的可阅读性。</li>
<li>用来获取计算结果。张量本身没有存储具体的数字，但是可以使用<strong>会话</strong>的tf.Session().run(result)来获取计算结果。</li>
</ul>

<h2 id="3-3-tensorflow的运行模型-会话">3.3 TensorFlow的运行模型——会话</h2>

<p><strong>会话（Session）拥有和管理TensorFlow中所有的运算，可以执行定义好的运算。</strong></p>

<p><strong>创建和关闭会话</strong></p>

<pre><code class="language-python"># 创建一个会话。
sess = tf.Session()

# 使用会话得到之前计算的结果。
print(sess.run(result))

# 关闭会话使得本次运行中使用到的资源可以被释放。
sess.close()
</code></pre>

<p>建议使用Python的<strong>上下文管理器</strong>，即通过<strong>with</strong>语法来创建会话，能够避免资源泄漏。</p>

<pre><code class="language-python">with tf.Session() as sess:
    print(sess.run(result))
</code></pre>

<p>在交互式环境下（比如Jupyter）直接使用<strong>tf.InteractiveSession</strong>函数创建<strong>交互式会话</strong>，将产生的会话直接注册为默认会话。</p>

<pre><code class="language-python">sess = tf.InteractiveSession ()
print(result.eval())
sess.close()
</code></pre>

<p>不论使用哪种会话都可以通过<strong>ConfigProto</strong>来配置<code>并行线程数</code>、<code>GPU分配策略</code>、<code>运算超时时间</code>等。</p>

<p>常用的两个配置有：</p>

<ul>
<li><strong>allow_soft_placement</strong>：布尔值，默认false，以下任何一个条件满足时则为true，允许将GPU上的运算放到CPU上进行。

<ul>
<li>运算无法在GPU上运行</li>
<li>GPU资源不足（没有GPU或者指定的GPU个数不够）</li>
<li>运算输入包括对CPU计算结果的引用</li>
</ul></li>
<li><strong>log_device_placement</strong>：布尔值，默认值是？如果为true的话，日志中将会记录每个节点被安排在哪个设备上，这方便调试。生产环境中一般设置为false，能够减少日志量。</li>
</ul>

<h2 id="3-4-tensorflow实现神经网络">3.4 TensorFlow实现神经网络</h2>

<p>To be continued…</p>

<p>10:39 p.m Thu Mar 30,2017</p>

            </article>
             
            <h2>See Also</h2>
            <ul>
                
                <li><a href="/blogs/tensorflow-practice-02/">TensorFlow实战（才云郑泽宇著）读书笔记——第二章TensorFlow环境搭建</a></li>
                
                <li><a href="/blogs/tensorflow-practice-01/">TensorFlow实战（才云郑泽宇著）读书笔记——第一章深度学习简介</a></li>
                
                <li><a href="/talks/microservice-reading-notes/">微服务设计读书笔记</a></li>
                
            </ul>
            
        </div>
    </section>

    
    

<aside id="meta">

<div>
    <section id="datecount">
        <h4 id="date"> Thu Mar 30, 2017 </h4>
        <h5 id="wc"> 2200 Words </h5>
        <h5 id="readtime"> Read in about 5 Min </h5>
    </section>
    <ul id="categories">
        
    </ul>
    <ul id="tags">
        
        <li> <a href="https://jimmysong.io//tags/tensorflow">tensorflow</a> </li>
        
        <li> <a href="https://jimmysong.io//tags/deep-learning">deep learning</a> </li>
        
        <li> <a href="https://jimmysong.io//tags/ai">AI</a> </li>
        
        <li> <a href="https://jimmysong.io//tags/google">google</a> </li>
        
        <li> <a href="https://jimmysong.io//tags/machine-learning">machine learning</a> </li>
        
        <li> <a href="https://jimmysong.io//tags/reading-notes">reading notes</a> </li>
        
        <li> <a href="https://jimmysong.io//tags/book">book</a> </li>
        
        <li> <a href="https://jimmysong.io//tags/tensorflow-practice-reading-notes">tensorflow practice reading notes</a> </li>
        
    </ul>
</div>

<div>
    <section id="prev">
        &nbsp;<a class="previous" href="https://jimmysong.io/blogs/kubernetes-network-config/"><i class="icon-arrow-left"></i> Kubernetes基于flannel的网络配置</a><br>
    </section>
    <section id="next">
        &nbsp;<a class="next" href="https://jimmysong.io/blogs/kubernetes-installation-on-centos/">在CentOS上安装kubernetes详细指南 <i class="icon-arrow-right"></i></a>
    </section>
</div>

<div>
    <section id="author">
        <h4>About the Author</h4>
        <p>
            <a href="https://jimmysong.io/about/">Jimmy Song</a> is a software engineer in Beijing, also an open source enthusiast and Big Data, Cloud Native fans. If you not see him front of computer, he must be traveling or taking pictures outside,
            visit the amazing pictures at <a href=https://jimmysongio.tuchong.com/>tuchong(图虫)</a>. Feel free to <a href=https://twitter.com/jimmysongio>follow him on twitter</a>.
        </p>
    </section>

</div>

</aside>

<meta itemprop="wordCount" content="2177">
<meta itemprop="datePublished" content="2017-03-30">
<meta itemprop="url" content="https://jimmysong.io/blogs/tensorflow-practice-03/">
 <footer>
    <div>
        <p>
            <a href="https://jimmysong.io/kubernetes-handbook">Kubernetes Handbook中文指南/实践手册</a> |
            <a href="https://jimmysong.io/cloud-native-go">Cloud Native Go</a> |
            <a href="https://jimmysong.io/awesome-cloud-native">Awesome Cloud Native</a> |
            <a href="https://jimmysong.io/migrating-to-cloud-native-application-architectures">迁移到云原生应用架构手册</a> |
            <a href="https://istio.doczh.cn/">Istio Service Mesh中文文档</a>
    </div>
    <div>
        <p>

        </p>
        <p> &copy; 2013-2017 <span itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Jimmy Song</span><span>
            Powered by <a href="https://gohugo.io">Hugo</a></span>
            </span>
    </div>
</footer>

<script type="text/javascript">
  var subscribersSiteId = 'a7ab708e-32cc-4176-b9ef-1359667987eb';
</script>
<script type="text/javascript" src="https://cdn.subscribers.com/assets/subscribers.js"></script>
</body>

</html>
