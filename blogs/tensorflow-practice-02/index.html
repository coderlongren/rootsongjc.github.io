<!DOCTYPE html>
<html class="no-js" lang="en-US" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">

<head>
    <meta charset="utf-8">
    <meta name="baidu-site-verification" content="g8IYR9SNLF" />
    <meta name="uyan_auth" content="419f63884b" /> <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="description" content="">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="keywords" content="tensorflow, deep learning, AI, google, machine learning, reading notes, book, tensorflow practice reading notes, ">

 
<meta property="og:type" content="article"/>
<meta property="og:description" content=""/>
<meta property="og:title" content="TensorFlow实战（才云郑泽宇著）读书笔记——第二章TensorFlow环境搭建 : jimmysong.io"/>
<meta property="og:site_name" content="rootsongjc is Jimmy Song"/>
<meta property="og:image" content="" />
<meta property="og:image:type" content="image/jpeg" />
<meta property="og:image:width" content="" />
<meta property="og:image:height" content="" />
<meta property="og:url" content="http://rootsongjc.github.io/blogs/tensorflow-practice-02/">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2017-03-23"/>
<meta property="article:modified_time" content="2017-03-23"/>



<meta property="article:tag" content="tensorflow">
<meta property="article:tag" content="deep learning">
<meta property="article:tag" content="AI">
<meta property="article:tag" content="google">
<meta property="article:tag" content="machine learning">
<meta property="article:tag" content="reading notes">
<meta property="article:tag" content="book">
<meta property="article:tag" content="tensorflow practice reading notes">




<meta name="twitter:card" content="summary">

<meta name="twitter:site" content="@rootsongjc">
<meta name="twitter:title" content="TensorFlow实战（才云郑泽宇著）读书笔记——第二章TensorFlow环境搭建 : jimmysong.io">
<meta name="twitter:creator" content="@rootsongjc">
<meta name="twitter:description" content="">
<meta name="twitter:image:src" content="">
<meta name="twitter:domain" content="jimmysong.io">

    <base href="http://rootsongjc.github.io/">
    <title> TensorFlow实战（才云郑泽宇著）读书笔记——第二章TensorFlow环境搭建 - Jimmy Song </title>
    <link rel="canonical" href="http://rootsongjc.github.io/blogs/tensorflow-practice-02/"> <link rel="stylesheet" href="/static/css/style.css">


<link href="/static/css/prism.css" rel="stylesheet" />
<script src="/static/js/prism.js"></script>


<script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?11f7d254cfa4e0ca44b175c66d379ecc";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

<script>
    (function() {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>
<div style='margin:0 auto;width:0px;height:0px;overflow:hidden; '>
    <img src='http://olz1di9xf.bkt.clouddn.com/jimmy.jpg' />
</div>
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
</head>

<body lang="en" itemscope itemtype="http://schema.org/Article">
    <header id="header">
    <figure>
      <a href="/" border=0 id="logolink"><div class="icon-octocat" id="logo"> </div></a>
    </figure>
    <div id="byline">by Jimmy Song</div>
    <nav id="nav">
            <ul id="mainnav">
            <li>
                <a href="/blogs/">
                <span class="icon"> <i aria-hidden="true" class="icon-quill"></i></span>
                <span> blogs </span>
            </a>
            </li>
            <li>
            <a href="/projects/">
                <span class="icon"> <i aria-hidden="true" class="icon-console"></i></span>
                <span> projects </span>
            </a>
            </li>
            <li>
            <a href="/talks/">
                <span class="icon"> <i aria-hidden="true" class="icon-stats"></i></span>
                <span> talks </span>
            </a>
            </li>
            <li>
            <a href="http://www.linkedin.com/in/rootsongjc">
                <span class="icon"> <i aria-hidden="true" class="icon-linkedin"></i></span>
                <span> me </span>
            </a>
            </li>
        </ul>

    <ul id="social">
    <li id="share">
        <span class="icon icon-bubbles"> </span>
        <span class="title"> share </span>
        <div class="dropdown share">
            <ul class="social">
                <li> <a href="https://twitter.com/intent/tweet?status=TensorFlow%e5%ae%9e%e6%88%98%ef%bc%88%e6%89%8d%e4%ba%91%e9%83%91%e6%b3%bd%e5%ae%87%e8%91%97%ef%bc%89%e8%af%bb%e4%b9%a6%e7%ac%94%e8%ae%b0%e2%80%94%e2%80%94%e7%ac%ac%e4%ba%8c%e7%ab%a0TensorFlow%e7%8e%af%e5%a2%83%e6%90%ad%e5%bb%ba-http%3a%2f%2frootsongjc.github.io%2fblogs%2ftensorflow-practice-02%2f" target="_blank" title="Follow me on Twitter" class="twitter"><span class="icon icon-twitter"></span>Twitter</a> </li>
                <li> <a href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2frootsongjc.github.io%2fblogs%2ftensorflow-practice-02%2f" target="_blank" title="Join me on Facebook" class="facebook"><span class="icon icon-facebook"></span>Facebook</a> </li>
                <li> <a href="https://plus.google.com/share?url=http%3a%2f%2frootsongjc.github.io%2fblogs%2ftensorflow-practice-02%2f" target="_blank" title="Google+" class="googleplus"><span class="icon icon-google-plus"></span>Google+</a> </li>
                <li> <a href="http://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2frootsongjc.github.io%2fblogs%2ftensorflow-practice-02%2f&title=TensorFlow%e5%ae%9e%e6%88%98%ef%bc%88%e6%89%8d%e4%ba%91%e9%83%91%e6%b3%bd%e5%ae%87%e8%91%97%ef%bc%89%e8%af%bb%e4%b9%a6%e7%ac%94%e8%ae%b0%e2%80%94%e2%80%94%e7%ac%ac%e4%ba%8c%e7%ab%a0TensorFlow%e7%8e%af%e5%a2%83%e6%90%ad%e5%bb%ba&source=spf13" target="_blank" title="LinkedIn" class="linkedin"><span class="icon icon-linkedin"></span>LinkedIn</a> </li>
                <li> <a href="http://del.icio.us/post?url=http%3a%2f%2frootsongjc.github.io%2fblogs%2ftensorflow-practice-02%2f" target="_blank" title="Delicious" class="delicious"><span class="icon icon-delicious"></span>Delicious</a> </li>
                <li> <a href="http://www.reddit.com/submit?url=http%3a%2f%2frootsongjc.github.io%2fblogs%2ftensorflow-practice-02%2f" target="_blank" title="Reddit" class="reddit"><span class="icon icon-reddit"></span>Reddit</a> </li>
            </ul>
            <span class="subcount">sharing is caring</span>
        </div>
    </li>
    <li id="follow">
        <span class="icon icon-rocket"> </span>
        <span class="title"> follow </span>
        <div class="dropdown follow">
            <ul class="social">
                <li> <a href="http://www.twitter.com/rootsongjc" target="_blank" title="Follow me on Twitter" class="twitter"><span class="icon icon-twitter"></span>Twitter</a> </li>
                <li> <a href="http://www.facebook.com/rootsongjc" target="_blank" title="Join me on Facebook" class="facebook"><span class="icon icon-facebook"></span>Facebook</a> </li>
                <li> <a href="http://www.linkedin.com/in/rootsongjc" target="_blank" title="LinkedIn" class="linkedin"><span class="icon icon-linkedin"></span>LinkedIn</a> </li>
                <li> <a href="http://github.com/rootsongjc" target="_blank" title="GitHub" class="github"><span class="icon icon-github"></span>GitHub</a> </li>
                <li> <a href="https://www.douban.com/people/deamonj/" target="_blank" title="豆瓣" class="facebook"><span class="icon icon-idea"></span>Douban</a> </li>
                <li> <a href="https://rootsongjc.tuchong.com/" target="_blank" title="图虫" class="github"><span class="icon icon-cc-2"></span>Tuchong</a> </li>
            </ul>
            <span class="subcount">join 10k+ subscribers &amp; followers</span>
        </div>
    </li>
</ul>
    </nav>
</header>
 

    <section id="main">
        <h1 itemprop="name" id="title">TensorFlow实战（才云郑泽宇著）读书笔记——第二章TensorFlow环境搭建</h1>
        <div>
            <article itemprop="articleBody" id="content">
                

<p><img src="http://olz1di9xf.bkt.clouddn.com/20140810002.jpg" alt="广州海珠桥" /></p>

<p><em>（题图：广州海珠桥 Aug 10,2014）</em></p>

<blockquote>
<p>这是我阅读<a href="caicloud.io">才云科技</a>郑泽宇的《TensorFlow实战Google深度学习框架》的读书笔记系列文章，按照文章的章节顺序来写的。整本书的笔记归档在<a href="http://rootsongjc.github.io/tags/tensorflow-practice-reading-notes/">这里</a>。</p>
</blockquote>

<p>P.S 本书的<strong>官方读者交流微信群（作者也在群里）</strong>已经超过100人，您可以先加我微信后我拉您进去，我的二维码在<a href="rootsongjc.github.io/about">这里</a>，或者直接搜索我的微信号jimmysong。</p>

<p>睇完这一章后应该就可以自己搭建出一个TensorFlow的环境，我之前在docker里玩过，镜像比较大，下载慢一点，不过用起来很方便，如果你仅仅是想试用一下TensorFlow，看看它能干什么的话，可以直接在docker里试用一下。在Mac上安装的详细步骤，<a href="https://www.tensorflow.org/install/install_mac">官方安装说明文档</a>。</p>

<h2 id="2-1-tensorflow的主要依赖包">2.1 TensorFlow的主要依赖包</h2>

<p>TensorFlow主要用到以下两个依赖：</p>

<ul>
<li><a href="https://developers.google.com/protocol-buffers/">Protocol buffer</a>：数据结构化工具。Google开源的结构化数据格式，用于网络传输数据时候的序列化和反序列化，使用的时候需要先定义schema，github地址<a href="https://github.com/google/protobuf。分布式TensorFlow使用到额gRPC也是使用Protocol">https://github.com/google/protobuf。分布式TensorFlow使用到额gRPC也是使用Protocol</a> Buffer来组织的，</li>
<li><a href="https://bazel.build/">Bazel</a>:自动化编译构建工具。Google开源的，github地址<a href="https://github.com/bazelbuild/bazel，它支持多语言、多平台、可重复编译和可伸缩，构建大型软件速度也是很快的。Bazel使用**项目空间**的形式管理编译的，每个项目空间需要包含[BUILD文件](https://github.com/tensorflow/tensorflow/blob/master/bower.BUILD)（定义编译目标）和[WORKSPACE](https://github.com/tensorflow/tensorflow/blob/master/WORKSPACE)文件（定义编译的依赖环境）。这两个文件都有点类似python语法。">https://github.com/bazelbuild/bazel，它支持多语言、多平台、可重复编译和可伸缩，构建大型软件速度也是很快的。Bazel使用**项目空间**的形式管理编译的，每个项目空间需要包含[BUILD文件](https://github.com/tensorflow/tensorflow/blob/master/bower.BUILD)（定义编译目标）和[WORKSPACE](https://github.com/tensorflow/tensorflow/blob/master/WORKSPACE)文件（定义编译的依赖环境）。这两个文件都有点类似python语法。</a></li>
</ul>

<h2 id="2-2-tensorflow安装">2.2 TensorFlow安装</h2>

<p>TensorFlow的安装方式包括docker镜像、pip安装、源码编译安装。</p>

<p><u>我选择最方便的docker镜像方式</u>，其他方式对本地环境做很多配置，折腾起来比较麻烦。</p>

<p>我早就在docker中安装过TensorFlow0.9小试过牛刀。现在<a href="https://github.com/tensorflow/tensorflow/releases">1.0.1版本</a>已经released了。TensorFlow的所有版本都有对应的docker镜像发布在<a href="https://hub.docker.com/r/tensorflow/tensorflow/tags/">docker hub</a>，可以直接<code>docker pull</code>安装。</p>

<p>为了和书中所用的镜像保持统一，我将使用caicloud提供的镜像，基于TensorFlow0.12.0（这个版本是2016年12月20日发布的），他们增加了一些其他机器学习工具包和TensorFlow可视化工具TensorBoard。</p>

<p><strong>docker镜像方式安装</strong></p>

<p>首先下载镜像，这个image比较大，下载下来比较费时间，我用了差不多15分钟吧。</p>

<pre><code class="language-shell">docker pull cargo.caicloud.io/tensorflow/tensorflow:0.12.0
</code></pre>

<p>下载下来后我们再check下这个大小为<strong>1.41GB</strong>镜像的layers。</p>

<p>另外还有个<a href="https://github.com/NVIDIA/nvidia-docker"><strong>nvidia</strong>版本的docker</a>，可以将你电脑的<strong>GPU</strong>派山用场，我暂时没用到GPU，我电脑装的是<code>docker17.03-ce</code>，就不折腾GPU版本的TensorFlow了。</p>

<pre><code>IMAGE               CREATED             CREATED BY                                      SIZE                COMMENT
c8a8409297f2        5 weeks ago         /bin/sh -c #(nop)  CMD [&quot;/run_tf.sh&quot;]           0 B                 
&lt;missing&gt;           5 weeks ago         /bin/sh -c #(nop) COPY file:78332d36244852...   122 B               
&lt;missing&gt;           5 weeks ago         /bin/sh -c #(nop) COPY dir:8b6ab7d235e3975...   21 MB               
&lt;missing&gt;           5 weeks ago         /bin/sh -c #(nop) COPY dir:fca915671040399...   360 MB              
&lt;missing&gt;           5 weeks ago         /bin/sh -c #(nop) COPY dir:69314aa937be649...   89.9 kB             
&lt;missing&gt;           5 weeks ago         /bin/sh -c rm -rf /notebooks/*                  0 B                 
&lt;missing&gt;           5 weeks ago         /bin/sh -c pip install caicloud.tensorflow      21.4 MB             
&lt;missing&gt;           5 weeks ago         /bin/sh -c pip install -U scikit-learn          39.9 kB             
&lt;missing&gt;           5 weeks ago         /bin/sh -c apt-get update &amp;&amp; apt-get insta...   23.9 MB             
&lt;missing&gt;           5 weeks ago         /bin/sh -c #(nop)  ENV LANG=C.UTF-8             0 B                 
&lt;missing&gt;           3 months ago        /bin/sh -c #(nop)  CMD [&quot;/run_jupyter.sh&quot;]      0 B                 
&lt;missing&gt;           3 months ago        /bin/sh -c #(nop)  WORKDIR /notebooks           0 B                 
&lt;missing&gt;           3 months ago        /bin/sh -c #(nop)  EXPOSE 8888/tcp              0 B                 
&lt;missing&gt;           3 months ago        /bin/sh -c #(nop)  EXPOSE 6006/tcp              0 B                 
&lt;missing&gt;           3 months ago        /bin/sh -c #(nop) COPY file:5485384c641ba7...   733 B               
&lt;missing&gt;           3 months ago        /bin/sh -c #(nop) COPY dir:388d24701b3b5bc...   400 kB              
&lt;missing&gt;           3 months ago        /bin/sh -c #(nop) COPY file:822af972b63c44...   1.06 kB             
&lt;missing&gt;           3 months ago        /bin/sh -c pip --no-cache-dir install http...   191 MB              
&lt;missing&gt;           3 months ago        /bin/sh -c pip --no-cache-dir install     ...   379 MB              
&lt;missing&gt;           3 months ago        /bin/sh -c curl -O https://bootstrap.pypa....   11.4 MB             
&lt;missing&gt;           3 months ago        /bin/sh -c apt-get update &amp;&amp; apt-get insta...   212 MB              
&lt;missing&gt;           3 months ago        /bin/sh -c #(nop)  MAINTAINER Craig Citro ...   0 B                 
&lt;missing&gt;           9 months ago        /bin/sh -c #(nop) CMD [&quot;/bin/bash&quot;]             0 B                 
&lt;missing&gt;           9 months ago        /bin/sh -c sed -i 's/^#\s*\(deb.*universe\...   1.9 kB              
&lt;missing&gt;           9 months ago        /bin/sh -c rm -rf /var/lib/apt/lists/*          0 B                 
&lt;missing&gt;           9 months ago        /bin/sh -c set -xe   &amp;&amp; echo '#!/bin/sh' &gt;...   195 kB              
&lt;missing&gt;           9 months ago        /bin/sh -c #(nop) ADD file:aca501360d0937b...   188 MB 
</code></pre>

<p>可以看到这是一个基于<strong>Ubuntu</strong>的docker image，这其中还包含了一个<strong>Jupyter notebook</strong>和一些python packages。</p>

<p>使用<code>docker image history —no-trunc $IMAGE_ID</code>命令可以看到每一层的详细信息。</p>

<p><strong>启动TensorFlow</strong></p>

<p>直接在docker中启动。</p>

<pre><code class="language-Shell">docker run -it -d -p 8888:8888 -p 6006:6006 --name tf-dev cargo.caicloud.io/tensorflow/tensorflow:0.12.0 
</code></pre>

<p>启动后进入<code>localhost:8888</code>页面，发现登陆jupyter居然还要输入密码，书中没说要输入密码啊，也没说密码是什么，密码在哪里呢？</p>

<blockquote>
<p>如何获取Jupyter的登录密码书中没有介绍。其实没必要修改镜像活着进入容器中需钙jupyter的配置，直接查看刚启动的<code>tf-dev</code>容器的日志即可，里面包含了登录密码。</p>
</blockquote>

<pre><code>docker logs tf-dev
[I 10:52:46.200 NotebookApp] Writing notebook server cookie secret to /root/.local/share/jupyter/runtime/notebook_cookie_secret
[W 10:52:46.244 NotebookApp] WARNING: The notebook server is listening on all IP addresses and not using encryption. This is not recommended.
[I 10:52:46.267 NotebookApp] Serving notebooks from local directory: /notebooks
[I 10:52:46.267 NotebookApp] 0 active kernels 
[I 10:52:46.267 NotebookApp] The Jupyter Notebook is running at: http://[all ip addresses on your system]:8888/?token=e64afc31eec843717733d6e4527aecf833ce18383214dc47
[I 10:52:46.267 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).
Starting TensorBoard 39 on port 6006
</code></pre>

<p>看到了吗，<code>tf-dev</code>容器的日志输出里就包括了密码，我的容器的jupyter的密码是<strong>token后面的那个字符串</strong>e64afc31eec843717733d6e4527aecf833ce18383214dc47。</p>

<p>现在用刚才从日志里看到的密码就可以登录了，Jupyter页面上可以看到本书所有章节的代码了。</p>

<p><img src="http://olz1di9xf.bkt.clouddn.com/tensorflow-practice-chapter2-jupyter-web.jpg" alt="jupyter页面" /></p>

<p><strong>使用pip安装</strong></p>

<p>另外我在mac上也用pip方式安装了。我安装的是最新版的1.0.1的CPU-only，加上<code>—user -U</code>是为了规避mac上的各种权限问题。</p>

<pre><code class="language-shell">pip install --upgrade tensorflow --user -U
</code></pre>

<p>下载的整个软件包只有39.3MB，速度还是很快的。</p>

            </article>
        </div>
    </section>

    
    

<aside id="meta">

<div>
    <section id="datecount">
        <h4 id="date"> Thu Mar 23, 2017 </h4>
        <h5 id="wc"> 2300 Words </h5>
        <h5 id="readtime"> Read in about 5 Min </h5>
    </section>
    <ul id="categories">
        
    </ul>
    <ul id="tags">
        
        <li> <a href="http://rootsongjc.github.io//tags/tensorflow">tensorflow</a> </li>
        
        <li> <a href="http://rootsongjc.github.io//tags/deep-learning">deep learning</a> </li>
        
        <li> <a href="http://rootsongjc.github.io//tags/ai">AI</a> </li>
        
        <li> <a href="http://rootsongjc.github.io//tags/google">google</a> </li>
        
        <li> <a href="http://rootsongjc.github.io//tags/machine-learning">machine learning</a> </li>
        
        <li> <a href="http://rootsongjc.github.io//tags/reading-notes">reading notes</a> </li>
        
        <li> <a href="http://rootsongjc.github.io//tags/book">book</a> </li>
        
        <li> <a href="http://rootsongjc.github.io//tags/tensorflow-practice-reading-notes">tensorflow practice reading notes</a> </li>
        
    </ul>
</div>

<div>
    <section id="prev">
        &nbsp;<a class="previous" href="http://rootsongjc.github.io/blogs/cloud-foundry-tryout/"><i class="icon-arrow-left"></i> Pivotal Cloud foundry快速开始指南</a><br>
    </section>
    <section id="next">
        &nbsp;<a class="next" href="http://rootsongjc.github.io/talks/container-applications-scenarios/">容器的应用场景 <i class="icon-arrow-right"></i></a>
    </section>
</div>

<div>
    <section id="author">
        <h4>About the Author</h4>
        <p>
            <a href="http://rootsongjc.github.io/about/">Jimmy Song</a> is a software engineer in Beijing, also an open source enthusiast and Big Data, Cloud Native fans. If you not see him front of computer, he must be traveling or taking pictures outside,
            visit the amazing pictures at <a href=https://rootsongjc.tuchong.com/>tuchong(图虫)</a>. Feel free to <a href=https://twitter.com/rootsongjc>follow him on twitter</a>.
        </p>
    </section>

</div>
</aside>

<meta itemprop="wordCount" content="2274">
<meta itemprop="datePublished" content="2017-03-23">
<meta itemprop="url" content="http://rootsongjc.github.io/blogs/tensorflow-practice-02/">
 <footer>
    <div>
        <p>
            &copy; 2013-2017 <span itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Jimmy Song</span></span>
            Powered by <a href="http://gohugo.io">Hugo</a>.
        </p>
    </div>
</footer>
</body>

</html>
